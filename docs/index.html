<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Volumetric Display</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body { margin: 0; display: block; }
    #iersPlot, #formulaPlot { width: 100vw; height: 50vh; }
  </style>
</head>
<body>
  <div id="iersPlot"></div>
  <div id="formulaPlot"></div>

  <script>
    // Fetch volumetric JSON
    fetch('volumetric_data.json')
      .then(response => response.json())
      .then(data => {
        const iersData = data.iers || [{"x":0,"y":0,"z":0}];
        const formulaData = data.formula || [{"x":0,"y":0,"z":0}];

        function mapXYZ(arr) {
          return {
            x: arr.map(p => p.x),
            y: arr.map(p => p.y),
            z: arr.map(p => p.z)
          };
        }

        // IERS plot
        const iersXYZ = mapXYZ(iersData);
        const iersTrace = {
          x: iersXYZ.x,
          y: iersXYZ.y,
          z: iersXYZ.z,
          mode: 'markers',
          type: 'scatter3d',
          marker: { size: 3, color: iersXYZ.z, colorscale: 'Viridis', opacity: 0.8 }
        };
        const iersLayout = { 
          margin: { l:0,r:0,b:0,t:0 }, 
          scene:{ xaxis:{title:'x_pole'}, yaxis:{title:'y_pole'}, zaxis:{title:'Year'} } 
        };
        Plotly.newPlot('iersPlot', [iersTrace], iersLayout, {responsive: true});

        // Formula plot
        const formulaXYZ = mapXYZ(formulaData);
        const formulaTrace = {
          x: formulaXYZ.x,
          y: formulaXYZ.y,
          z: formulaXYZ.z,
          mode: 'markers',
          type: 'scatter3d',
          marker: { size: 3, color: formulaXYZ.z, colorscale: 'Plasma', opacity: 0.8 }
        };
        const formulaLayout = { 
          margin: { l:0,r:0,b:0,t:0 }, 
          scene:{ xaxis:{title:'x'}, yaxis:{title:'y'}, zaxis:{title:'z'} } 
        };
        Plotly.newPlot('formulaPlot', [formulaTrace], formulaLayout, {responsive: true});

      })
      .catch(err => console.error("Error loading volumetric JSON:", err));
  </script>
</body>
</html>
